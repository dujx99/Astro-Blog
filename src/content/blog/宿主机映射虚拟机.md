---
title: "宿主机映射虚拟机"
categories: Share
tags: ["虚拟机", "Ubuntu", "Windows", "技术", "教程"]
id: "host-machine-maps-virtual-machine"
date: 2025-09-01 12:20:46
cover: "https://image.dujx.top/1764926153741.png"
---

:::note{type="info"}
本文介绍如何在 **Windows 宿主机** 中，通过 **VMware NAT** 网络，将运行在 **Ubuntu 虚拟机** 内的文件夹以 **Samba 共享** 的方式映射到 Windows。主要流程包括：

1. **在 Ubuntu 虚拟机安装并配置 Samba**：创建共享目录、设置访问用户与权限。

2. **在 Windows 上映射网络驱动器**：通过 `\\虚拟机IP\共享名称` 访问虚拟机中文件。

3. 使用 **服务密码**（Samba 密码）完成认证，即可在 Windows 的“网络位置”中直接访问虚拟机的目录。

这种方式适合在宿主机与虚拟机之间进行高效的文件同步与开发协作。
:::

## 环境

- 宿主机：Window 10，虚拟机：Ubuntu，服务：`samba`
- VMware 中，**网络适配器** 选择 **NAT** 模式

## Ubuntu 虚拟机安装 `samba` 服务

```bash
sudo apt update
sudo apt install samba
```

## 配置 Samba

删除原有配置，创建新配置，修改配置

```bash
rm /etc/samba/smb.conf
touch /etc/samba/smb.conf
vim /etc/samba/smb.conf
```

在配置文件中加入如下内容。其中 **global** 中的内容不要动，其余按需修改。**[dujx]** 代表路径名称，**path** 是需要共享的文件夹，**valid users** 是认证用的用户

```bash
[global]
	dns proxy = No
	log file = /var/log/samba/log.%m
	map to guest = Bad User
	max log size = 1000
	security = USER
	server string = Samba Server %v
	idmap config * : backend = tdb

[dujx]
	comment = Shared Directory for Windows
	create mask = 0775
	directory mask = 0775
	path = /root/work/dujx/
	read only = No
	valid users = root
```

设置 SMB 用户的密码

```bash
sudo smbpasswd -a root
```

重启 Samba 服务

```bash
sudo systemctl restart smbd nmbd
```

配置防火墙

```bash
sudo ufw allow samba
```

## 映射文件夹

获取虚拟机 IP 地址

```bash
ifconfig
```

Windows 下打开 **此电脑** ，右键选择映射网络驱动器

![image.png](https://cdn.jsdelivr.net/gh/dujx99/note-gen-image-sync@main/523bfe02-3ed4-41c1-830f-81488c0c4e4e.png)

地址格式为 `\\ip\路径名称` ，路径名称要与配置文件中的名称一致。勾选 **使用其他凭据连接**
![image.png](https://cdn.jsdelivr.net/gh/dujx99/note-gen-image-sync@main/d7d96ea7-f7f8-4654-99f5-9a6081bac692.png)

用户名用 **root** ，密码需要使用用户的 **服务密码**， 而不是用户密码
![image.png](https://cdn.jsdelivr.net/gh/dujx99/note-gen-image-sync@main/6a2bade6-2bc3-4154-ae1c-d07b4e2a044a.png)

映射成功后，可以在 Windows 下的 **网络位置** 看到

![image.png](https://cdn.jsdelivr.net/gh/dujx99/note-gen-image-sync@main/297bfc6f-f6f6-465f-a1d9-8db4af53875a.png)
